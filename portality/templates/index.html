{% extends "base.html" %}

{% block content %}




<div class="strap" style="background-image:url('/static/mountain.jpg');background-repeat:no-repeat;background-size:100%;">
    <div class="container">    
        <div class="row">
            <div class="col-md-1">
                <a href="/#download"><img class="img" src="/static/oabutton_logo_final200.png" style="height:100px;margin-top:-20px;"></a>
            </div>
            <div class="col-md-4">
                <h2>Open Access Button</h2>
            </div>
            <div class="col-md-7">
                <h3 style="padding-top:5px;float:right;">We can help you get access to research</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8">
                <div style="background-color:black;width:100%;height:400px;">
                <p>A placeholder for pictures or a video</p>
                </div>
            </div>
            <div class="col-md-4" id="topper">
                <h1>Push Button. <br>Get Research. <br>Make Progress.</h1>
                <p style="text-align:justify;">You all know the frustration of finding the research paper you need, 
                but you can’t afford the $40 to access it. The Open Access Button helps you get the research 
                you want right now, and adds papers you still need to your wishlists.</p>
                <p><br><a class="btn btn-large btn-block btn-action" href="/#how">Learn more about how it works</a></p>
            </div>
        </div>
    </div>
</div>




<a name="how"> </a>
<div class="strap">
    <div class="container">    
        <h1>HOW THE BUTTON WORKS</h1>
        <div class="row">
            <div class="col-md-4">
                <h2>Push Button.</h2>
                <p style="width:100%;height:200px;background-color:black;">Image placeholder</p>
                <p>The next time you’re asked to pay to access academic research. 
                Push the Open Access Button on your phone or on the web.</p>
            </div>
            <div class="col-md-4">
                <h2>Get Research.</h2>
                <p style="width:100%;height:200px;background-color:black;">Image placeholder</p>
                <p>The Open Access Button will search the web for version of the paper that 
                you can access immediately. If that doesn’t work, the Button will email the 
                author and look for more information about the paper. </p>
            </div>
            <div class="col-md-4">
                <h2>Make Progress.</h2>
                <p style="width:100%;height:200px;background-color:black;">Image placeholder</p>
                <p>If you get your research, you can make progress with your work. If you 
                don’t get your research, your story will be used to help change the publishing 
                system so it doesn’t happen again.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/#media">See how people are using it</a></p>
            </div>
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/docs">Check out our API docs</a></p>
            </div>
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/#download">Get your own button</a></p>
            </div>
        </div>
    </div>
</div>





<a name="media"> </a>
<div class="strap" style="border-top:20px solid #fff;">
    <div class="container">
        <h1 style="color:white;">USING THE BUTTON</h1>
        <div class="row">
            <div class="col-md-4">
                <div class="bubble"><p>Tools like the Open Access Button can help catalyse change and create a 
                world where science has more impact, is more efficient and importantly available to everyone</p></div>
                <p>Professor Randy Schekman, Nobel Prize in Physiology or Medicine 2013.</p>
            </div>
            <div class="col-md-4">
                <div class="bubble"><p>I am even more impressed by the Open Access Button, 
                a genuinely grass-roots initiative developed by two students.</p></div>
                <p>Sander Dekker, State Secretary, Dutch Ministry of Education, Culture and Science.</p>

                <div class="bubble"><p>The use of the Open Access Button will help more people to find research papers.</p></div>
                <p>Professor Stephen Curry, The Guardian.</p>
            </div>
            <div class="col-md-4">
                <div id="mapspace" style="width:350px;height:350px;margin-top:-45px;">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/#download">Get your own button</a></p>
            </div>
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/action">Learn more about how people use research</a></p>
            </div>
            <div class="col-md-4">
                <p><a class="btn btn-large btn-block btn-action" href="/action">Get involved with improving access</a></p>
            </div>
        </div>
    </div>
</div>






<script>
jQuery(document).ready(function() {

    mapresponse = undefined;
    var updatemap = function(data) {
        mapresponse = data;
        $('.point').remove();
        draw(topo);
    }

    var defaultmapquery = {"query": {"match_all": {} } }    
    var mapquery = function(qry) {
        // get the query from the search query but change the size to max and specify required fields
        qry.size = 100000,
        qry.fields = [
            "coords.lat",
            "coords.lng"
        ]
        qry.facets = {};
        $.ajax({
            type: 'GET',
            url: '/query/?source=' + JSON.stringify(qry),
            dataType: 'JSONP',
            success: updatemap
        });
    }
    mapquery(defaultmapquery);
    
    d3.select(window).on("resize", throttle);
        
    var width = document.getElementById('mapspace').offsetWidth;
    var height = width;
    
    var topo,projection,path,svg,g;
    
    var tooltip = d3.select("#mapspace").append("div").attr("class", "tooltip hidden");
    
    setup(width,height);
    
    function setup(width,height){
      projection = d3.geo.orthographic()
        .translate([(width/2.5), (height)])
        .center([100, -100 ]);
      projection.rotate([10,-15,0]);
    
      path = d3.geo.path().projection(projection);
    
      svg = d3.select("#mapspace").append("svg")
          .attr("width", width)
          .attr("height", height)
          .append("g");
    
      g = svg.append("g");
        
    }
    
    d3.json("/static/vendor/d3/world-topo-min.json", function(error, world) {
    
      var countries = topojson.feature(world, world.objects.countries).features;
    
      topo = countries;
      draw(topo);
    
    });
    
    function draw(topo) {
    
      var country = g.selectAll(".country").data(topo);
    
      country.enter().insert("path")
          .attr("class", "country")
          .attr("d", path)
          .attr("id", function(d,i) { return d.id; })
          .attr("title", function(d,i) { return d.properties.name; })
          .style("fill", '#212f3f');
    
      //add points and repo suggestions
      if ( mapresponse ) {
          mapresponse.hits.hits.forEach(function(i){
              addpoint(
                i.fields["coords.lng"],
                i.fields["coords.lat"]
              );
          });
      }
    
    }
    
    
    function redraw() {
      width = document.getElementById('mapspace').offsetWidth;
      height = width;
      d3.select('svg').remove();
      setup(width,height);
      draw(topo);
    }
    
    
    
    
    var throttleTimer;
    function throttle() {
      window.clearTimeout(throttleTimer);
        throttleTimer = window.setTimeout(function() {
          redraw();
        }, 200);
    }


    //function to add points and text to the map (used in plotting capitals)
    function addpoint(lat,lon) {
    
      var gpoint = g.append("g").attr("class", "gpoint");
      var x = projection([lat,lon])[0];
      var y = projection([lat,lon])[1];
    
      gpoint.append("svg:circle")
            .attr("cx", x)
            .attr("cy", y)
            .attr("class","point")
            .attr("r", 1)
            .style("fill", '#f04717');
    
    }


});
</script>


{% endblock %}

